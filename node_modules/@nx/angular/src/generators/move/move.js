"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.angularMoveGenerator = void 0;
const tslib_1 = require("tslib");
const devkit_1 = require("@nx/devkit");
const generators_1 = require("@nx/workspace/generators");
const lib_1 = require("./lib");
/**
 * Moves an Angular lib/app to another folder (and renames it in the process)
 *
 * @remarks It's important to note that `updateModuleName` is done after the update
 * to the workspace, so it can't use the same tricks as the `@nx/workspace` rules
 * to get the before and after names and paths.
 */
function angularMoveGenerator(tree, schema) {
    return tslib_1.__awaiter(this, void 0, void 0, function* () {
        const normalizedSchema = (0, lib_1.normalizeSchema)(tree, schema);
        yield (0, generators_1.moveGenerator)(tree, Object.assign(Object.assign({}, schema), { skipFormat: true }));
        (0, lib_1.updateModuleName)(tree, normalizedSchema);
        (0, lib_1.updateNgPackage)(tree, normalizedSchema);
        (0, lib_1.updateSecondaryEntryPoints)(tree, normalizedSchema);
        if (!normalizedSchema.skipFormat) {
            yield (0, devkit_1.formatFiles)(tree);
        }
    });
}
exports.angularMoveGenerator = angularMoveGenerator;
