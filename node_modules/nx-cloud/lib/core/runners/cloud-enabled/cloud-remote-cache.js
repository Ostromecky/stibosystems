const a2_0x377c=['fileStorage','Nx\x20Cloud:\x20Skipping\x20storing\x20','../../../utilities/environment','push','get','delayedStoreRequests','retrieve','statuses','filter','indexOf','done','CloudRemoteCache','value','extractErrorMessage','next','reduce','../../../utilities/nx-imports-light','cacheError','Maybe\x20you\x20are\x20using\x20a\x20read-only\x20token\x20or\x20the\x20artifact\x20has\x20already\x20being\x20uploaded.','distributedExecutionId','resolve','api','cache-miss','response','storage','messages','throw','put','axiosException','__esModule','requests','VERBOSE_LOGGING','note','__awaiter','storeRequests','then','forEach','Nx\x20Cloud:\x20Cache\x20miss\x20','store','storeInCurrentProcess','remote-cache-hit','map','hashUrls','runContext','hash'];(function(_0x7f96d,_0x377c27){const _0x148702=function(_0x19eac2){while(--_0x19eac2){_0x7f96d['push'](_0x7f96d['shift']());}};_0x148702(++_0x377c27);}(a2_0x377c,0x66));const a2_0x1487=function(_0x7f96d,_0x377c27){_0x7f96d=_0x7f96d-0x0;let _0x148702=a2_0x377c[_0x7f96d];return _0x148702;};'use strict';var __awaiter=this&&this[a2_0x1487('0x15')]||function(_0x487d38,_0x4c4f0b,_0x3f255d,_0x5f238d){function _0x15be2b(_0x2369a4){return _0x2369a4 instanceof _0x3f255d?_0x2369a4:new _0x3f255d(function(_0x9b5c33){_0x9b5c33(_0x2369a4);});}return new(_0x3f255d||(_0x3f255d=Promise))(function(_0x22e016,_0x2b2aab){function _0x20500d(_0x2a73ad){try{_0x36f8cd(_0x5f238d[a2_0x1487('0x2')](_0x2a73ad));}catch(_0x31257b){_0x2b2aab(_0x31257b);}}function _0x4cbfc9(_0x34aa83){try{_0x36f8cd(_0x5f238d[a2_0x1487('0xe')](_0x34aa83));}catch(_0x1c9b91){_0x2b2aab(_0x1c9b91);}}function _0x36f8cd(_0x30635e){_0x30635e[a2_0x1487('0x2b')]?_0x22e016(_0x30635e[a2_0x1487('0x0')]):_0x15be2b(_0x30635e[a2_0x1487('0x0')])[a2_0x1487('0x17')](_0x20500d,_0x4cbfc9);}_0x36f8cd((_0x5f238d=_0x5f238d['apply'](_0x487d38,_0x4c4f0b||[]))['next']());});};Object['defineProperty'](exports,a2_0x1487('0x11'),{'value':!![]});exports['CloudRemoteCache']=void 0x0;const environment_1=require(a2_0x1487('0x23'));const {output}=require(a2_0x1487('0x4'));class CloudRemoteCache{constructor(_0x321475,_0x4a90d7,_0x41d167,_0x4c32b2,_0x302bb7,_0x1285b4){this[a2_0x1487('0xd')]=_0x321475;this[a2_0x1487('0x9')]=_0x4a90d7;this['runContext']=_0x41d167;this[a2_0x1487('0x21')]=_0x4c32b2;this[a2_0x1487('0x7')]=_0x302bb7;this[a2_0x1487('0x1b')]=_0x1285b4;this[a2_0x1487('0x16')]=[];this[a2_0x1487('0x26')]=[];}[a2_0x1487('0x27')](_0x4e7228,_0x2ef9e4){var _0x1eecc9;return __awaiter(this,void 0x0,void 0x0,function*(){if(this['messages'][a2_0x1487('0x5')])return![];const _0x5afab1=yield this[a2_0x1487('0x1e')](_0x4e7228);if(!_0x5afab1||!_0x5afab1['get']){if(environment_1[a2_0x1487('0x13')]){output[a2_0x1487('0x14')]({'title':a2_0x1487('0x19')+_0x4e7228+'.'});}this[a2_0x1487('0x1f')]['statuses'][_0x4e7228]=a2_0x1487('0xa');return![];}try{yield this[a2_0x1487('0x21')][a2_0x1487('0x27')](_0x4e7228,_0x5afab1[a2_0x1487('0x25')],_0x2ef9e4);this['runContext'][a2_0x1487('0x28')][_0x4e7228]=a2_0x1487('0x1c');return!![];}catch(_0x215b01){const _0x2e7f20=(_0x1eecc9=_0x215b01[a2_0x1487('0x10')])!==null&&_0x1eecc9!==void 0x0?_0x1eecc9:_0x215b01;if(_0x2e7f20['response']&&_0x2e7f20[a2_0x1487('0xb')]['status']===0x194){if(environment_1['VERBOSE_LOGGING']){output['note']({'title':'Nx\x20Cloud:\x20Cache\x20miss\x20'+_0x4e7228+'.\x20Status\x20404.'});}}else{this['messages'][a2_0x1487('0x5')]=this[a2_0x1487('0xd')][a2_0x1487('0x1')](_0x2e7f20,a2_0x1487('0xc'));}this[a2_0x1487('0x1f')][a2_0x1487('0x28')][_0x4e7228]='cache-miss';return![];}});}['store'](_0x12a3a2,_0xf68b6a){return __awaiter(this,void 0x0,void 0x0,function*(){if(this[a2_0x1487('0xd')][a2_0x1487('0x5')])return![];const _0x2256a0=Promise[a2_0x1487('0x8')]()[a2_0x1487('0x17')](()=>__awaiter(this,void 0x0,void 0x0,function*(){var _0x38495b;const _0x40e832=yield this['hashUrls'](_0x12a3a2);if(!_0x40e832)return![];if(!_0x40e832['put']){if(environment_1[a2_0x1487('0x13')]){output[a2_0x1487('0x14')]({'title':a2_0x1487('0x22')+_0x12a3a2+'.','bodyLines':['There\x20are\x20several\x20reasons\x20why\x20this\x20can\x20happen.',a2_0x1487('0x6')]});}return!![];}if(!this[a2_0x1487('0x1b')]){this[a2_0x1487('0x26')]['push']({'hash':_0x12a3a2,'url':_0x40e832[a2_0x1487('0xf')]});return!![];}try{yield this[a2_0x1487('0x21')][a2_0x1487('0x1a')](_0x12a3a2,_0x40e832['put'],_0xf68b6a);return!![];}catch(_0x484a66){const _0x394bee=(_0x38495b=_0x484a66[a2_0x1487('0x10')])!==null&&_0x38495b!==void 0x0?_0x38495b:_0x484a66;this[a2_0x1487('0xd')][a2_0x1487('0x5')]=this[a2_0x1487('0xd')]['extractErrorMessage'](_0x394bee,a2_0x1487('0xc'));return![];}}));this['storeRequests']['push'](_0x2256a0);return _0x2256a0;});}['hashUrls'](_0x1fcc0f){return __awaiter(this,void 0x0,void 0x0,function*(){if(_0x1fcc0f in this[a2_0x1487('0x1f')][a2_0x1487('0x12')]){return(yield this[a2_0x1487('0x1f')][a2_0x1487('0x12')][_0x1fcc0f])[_0x1fcc0f];}else{const _0x2e8e3c=this[a2_0x1487('0x1f')]['scheduledTasks'][a2_0x1487('0x29')](_0x528c90=>!this[a2_0x1487('0x1f')][a2_0x1487('0x12')][_0x528c90[a2_0x1487('0x20')]])[a2_0x1487('0x1d')](_0x6bef0c=>_0x6bef0c[a2_0x1487('0x20')]);if(_0x2e8e3c[a2_0x1487('0x2a')](_0x1fcc0f)===-0x1){_0x2e8e3c[a2_0x1487('0x24')](_0x1fcc0f);}const _0x517376=this[a2_0x1487('0x9')]['startRun'](this[a2_0x1487('0x7')],_0x2e8e3c);_0x2e8e3c[a2_0x1487('0x18')](_0x5740a3=>{this[a2_0x1487('0x1f')]['requests'][_0x5740a3]=_0x517376;});return(yield _0x517376)[_0x1fcc0f];}});}['waitForStoreRequestsToComplete'](){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x2a31ad=yield Promise['all'](this['storeRequests'])[a2_0x1487('0x17')](_0x8b6ade=>_0x8b6ade[a2_0x1487('0x3')]((_0x27de5b,_0x1b6286)=>_0x27de5b&&_0x1b6286,!![]));if(!_0x2a31ad){throw new Error('Error\x20when\x20storing\x20artifacts');}});}}exports[a2_0x1487('0x2c')]=CloudRemoteCache;