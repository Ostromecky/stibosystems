const a10_0x2fc3=['completeRunGroupWithError','response','done','createMetricRecorder','parallel','../../../utilities/serializer-overrides','note','data','ciExecutionId:\x20','maxParallel','__awaiter','ciExecutionEnv:\x20','../../../utilities/nx-imports-light','../../../utilities/axios','VERBOSE_LOGGING','createApiAxiosInstance','Workspace\x20is\x20disabled.\x20Cannot\x20perform\x20distributed\x20task\x20executions.','then','../../../utilities/metric-logger','project','RUNNER_FAILURE_PERF_ENTRY','mapRespToPerfEntry','axiosException','../../../utilities/environment','DistributedExecutionApi','map','completeRunGroup','axiosMultipleTries','false','error','NX_CLOUD_DISTRIBUTED_EXECUTION_STOP_AGENTS_ON_FAILURE','recordMetric','next','error:\x20','dteStatus','configuration','enabled','target','runGroup:\x20','agentCount','/nx-cloud/executions/start','value','apiAxiosInstance','defineProperty','throw','serializeOverrides','stopAgentsOnFailure','createStartRequest','post','dteStart','message','NX_CLOUD_DISTRIBUTED_EXECUTION_AGENT_COUNT','hash'];(function(_0x15e2e8,_0x2fc389){const _0x286c80=function(_0x26b387){while(--_0x26b387){_0x15e2e8['push'](_0x15e2e8['shift']());}};_0x286c80(++_0x2fc389);}(a10_0x2fc3,0xbf));const a10_0x286c=function(_0x15e2e8,_0x2fc389){_0x15e2e8=_0x15e2e8-0x0;let _0x286c80=a10_0x2fc3[_0x15e2e8];return _0x286c80;};'use strict';var __awaiter=this&&this[a10_0x286c('0x1f')]||function(_0xc51bb5,_0x4f2fe4,_0x20f491,_0x169768){function _0x37f194(_0xcbb544){return _0xcbb544 instanceof _0x20f491?_0xcbb544:new _0x20f491(function(_0x1ee696){_0x1ee696(_0xcbb544);});}return new(_0x20f491||(_0x20f491=Promise))(function(_0xf32f98,_0x44737f){function _0x15dbf0(_0x2d0527){try{_0x4b41ed(_0x169768[a10_0x286c('0x0')](_0x2d0527));}catch(_0x3e44ce){_0x44737f(_0x3e44ce);}}function _0x485887(_0x524294){try{_0x4b41ed(_0x169768[a10_0x286c('0xc')](_0x524294));}catch(_0x402185){_0x44737f(_0x402185);}}function _0x4b41ed(_0xb5d64c){_0xb5d64c[a10_0x286c('0x17')]?_0xf32f98(_0xb5d64c['value']):_0x37f194(_0xb5d64c[a10_0x286c('0x9')])[a10_0x286c('0x26')](_0x15dbf0,_0x485887);}_0x4b41ed((_0x169768=_0x169768['apply'](_0xc51bb5,_0x4f2fe4||[]))['next']());});};Object[a10_0x286c('0xb')](exports,'__esModule',{'value':!![]});exports['createStartRequest']=exports['DistributedExecutionApi']=void 0x0;const axios_1=require(a10_0x286c('0x22'));const environment_1=require(a10_0x286c('0x2c'));const metric_logger_1=require(a10_0x286c('0x27'));const serializer_overrides_1=require(a10_0x286c('0x1a'));const {output}=require(a10_0x286c('0x21'));class DistributedExecutionApi{constructor(_0x2f809c){this[a10_0x286c('0xa')]=(0x0,axios_1[a10_0x286c('0x24')])(_0x2f809c);}['start'](_0x2da6aa){var _0x48d76b;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x1b0bac=(0x0,metric_logger_1[a10_0x286c('0x18')])(a10_0x286c('0x11'));let _0x8d952d;if(environment_1[a10_0x286c('0x23')]){output['note']({'title':'Starting\x20a\x20distributed\x20execution','bodyLines':[JSON['stringify'](_0x2da6aa,null,0x2)]});}try{_0x8d952d=yield(0x0,axios_1[a10_0x286c('0x30')])(()=>this[a10_0x286c('0xa')]['post'](a10_0x286c('0x8'),_0x2da6aa));_0x1b0bac[a10_0x286c('0x34')]((0x0,metric_logger_1[a10_0x286c('0x2a')])(_0x8d952d));}catch(_0x4abfe8){_0x1b0bac[a10_0x286c('0x34')](((_0x48d76b=_0x4abfe8===null||_0x4abfe8===void 0x0?void 0x0:_0x4abfe8['axiosException'])===null||_0x48d76b===void 0x0?void 0x0:_0x48d76b['response'])?(0x0,metric_logger_1[a10_0x286c('0x2a')])(_0x4abfe8[a10_0x286c('0x2b')][a10_0x286c('0x16')]):metric_logger_1[a10_0x286c('0x29')]);throw _0x4abfe8;}if(!_0x8d952d[a10_0x286c('0x1c')][a10_0x286c('0x4')]){throw new Error(a10_0x286c('0x25'));}if(_0x8d952d[a10_0x286c('0x1c')][a10_0x286c('0x32')]){throw new Error(_0x8d952d[a10_0x286c('0x1c')][a10_0x286c('0x32')]);}return _0x8d952d[a10_0x286c('0x1c')]['id'];});}['status'](_0x1013b0){var _0x3d1362;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x4fdf9d=(0x0,metric_logger_1[a10_0x286c('0x18')])(a10_0x286c('0x2'));try{const _0x322782=yield(0x0,axios_1[a10_0x286c('0x30')])(()=>this[a10_0x286c('0xa')][a10_0x286c('0x10')]('/nx-cloud/executions/status',{'id':_0x1013b0}));_0x4fdf9d[a10_0x286c('0x34')]((0x0,metric_logger_1[a10_0x286c('0x2a')])(_0x322782));return _0x322782['data'];}catch(_0x28abd1){_0x4fdf9d['recordMetric'](((_0x3d1362=_0x28abd1===null||_0x28abd1===void 0x0?void 0x0:_0x28abd1[a10_0x286c('0x2b')])===null||_0x3d1362===void 0x0?void 0x0:_0x3d1362[a10_0x286c('0x16')])?(0x0,metric_logger_1[a10_0x286c('0x2a')])(_0x28abd1['axiosException'][a10_0x286c('0x16')]):metric_logger_1[a10_0x286c('0x29')]);output['error']({'title':_0x28abd1[a10_0x286c('0x12')]});process['exit'](0x1);}});}[a10_0x286c('0x15')](_0x1761e3,_0xdd39bb,_0x289dec,_0x5310b8,_0xff4b26){var _0xcc7658;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x550184=(0x0,metric_logger_1[a10_0x286c('0x18')])(a10_0x286c('0x2f'));if(environment_1[a10_0x286c('0x23')]){output[a10_0x286c('0x1b')]({'title':'Completing\x20with\x20an\x20error','bodyLines':[a10_0x286c('0x1d')+_0x289dec,a10_0x286c('0x20')+_0x5310b8,a10_0x286c('0x6')+_0xdd39bb,a10_0x286c('0x1')+_0xff4b26]});}try{const _0x252a5c=yield(0x0,axios_1[a10_0x286c('0x30')])(()=>this[a10_0x286c('0xa')][a10_0x286c('0x10')]('/nx-cloud/executions/complete-run-group',{'branch':_0x1761e3,'runGroup':_0xdd39bb,'ciExecutionId':_0x289dec,'ciExecutionEnv':_0x5310b8,'criticalErrorMessage':_0xff4b26}),0x3);_0x550184[a10_0x286c('0x34')]((0x0,metric_logger_1['mapRespToPerfEntry'])(_0x252a5c));}catch(_0x548b0b){_0x550184['recordMetric'](((_0xcc7658=_0x548b0b===null||_0x548b0b===void 0x0?void 0x0:_0x548b0b[a10_0x286c('0x2b')])===null||_0xcc7658===void 0x0?void 0x0:_0xcc7658[a10_0x286c('0x16')])?(0x0,metric_logger_1[a10_0x286c('0x2a')])(_0x548b0b[a10_0x286c('0x2b')][a10_0x286c('0x16')]):metric_logger_1[a10_0x286c('0x29')]);}});}}exports[a10_0x286c('0x2d')]=DistributedExecutionApi;function createStartRequest(_0x189c60,_0x3072d2,_0x461e7c,_0x431644,_0xd1b92c,_0x380335,_0x2d9669){const _0x345d11=_0xd1b92c[a10_0x286c('0x2e')](_0x1d57b1=>{return _0x1d57b1[a10_0x286c('0x2e')](_0x2778ff=>{return{'taskId':_0x2778ff['id'],'hash':_0x2778ff[a10_0x286c('0x14')],'projectName':_0x2778ff[a10_0x286c('0x5')][a10_0x286c('0x28')],'target':_0x2778ff[a10_0x286c('0x5')][a10_0x286c('0x5')],'configuration':_0x2778ff[a10_0x286c('0x5')][a10_0x286c('0x3')]||null,'params':(0x0,serializer_overrides_1[a10_0x286c('0xd')])(_0x2778ff)};});});const _0xbdb4fd={'command':(0x0,environment_1['parseCommand'])(),'branch':_0x189c60,'runGroup':_0x3072d2,'ciExecutionId':_0x461e7c,'ciExecutionEnv':_0x431644,'tasks':_0x345d11,'maxParallel':calculateMaxParallel(_0x380335),'commitSha':_0x2d9669};if(environment_1[a10_0x286c('0x13')]){_0xbdb4fd[a10_0x286c('0x7')]=environment_1[a10_0x286c('0x13')];}if(!environment_1[a10_0x286c('0x33')]){_0xbdb4fd[a10_0x286c('0xe')]=![];}return _0xbdb4fd;}exports[a10_0x286c('0xf')]=createStartRequest;function calculateMaxParallel(_0x4327a9){if(_0x4327a9[a10_0x286c('0x19')]===a10_0x286c('0x31')||_0x4327a9['parallel']===![]){return 0x1;}else if(_0x4327a9[a10_0x286c('0x19')]==='true'||_0x4327a9[a10_0x286c('0x19')]===!![]){return Number(_0x4327a9[a10_0x286c('0x1e')]||0x3);}else if(_0x4327a9[a10_0x286c('0x19')]===undefined){return _0x4327a9['maxParallel']?Number(_0x4327a9[a10_0x286c('0x1e')]):0x3;}else{return Number(_0x4327a9[a10_0x286c('0x19')])||0x3;}}